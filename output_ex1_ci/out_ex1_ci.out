we are running from this directory: /cluster/home/miriamfi/RankRec
The name of the job is: ex1_ci
The job ID is 337166
The job was run on these nodes: idun-02-01
Number of nodes: 1
We are using 1 cores
We are using 1 cores per node
Total of 1 cores

Currently Loaded Modules:
  1) GCCcore/9.3.0
  2) zlib/1.2.11-GCCcore-9.3.0                     (H)
  3) binutils/2.34-GCCcore-9.3.0                   (H)
  4) iccifort/2020.1.217
  5) numactl/2.0.13-GCCcore-9.3.0                  (H)
  6) UCX/1.8.0-GCCcore-9.3.0                       (H)
  7) impi/2019.7.217-iccifort-2020.1.217
  8) iimpi/2020a
  9) imkl/2020.1.217-iimpi-2020a
 10) intel/2020a
 11) bzip2/1.0.8-GCCcore-9.3.0                     (H)
 12) ncurses/6.2-GCCcore-9.3.0                     (H)
 13) libreadline/8.0-GCCcore-9.3.0                 (H)
 14) Tcl/8.6.10-GCCcore-9.3.0                      (H)
 15) SQLite/3.31.1-GCCcore-9.3.0                   (H)
 16) XZ/5.2.5-GCCcore-9.3.0                        (H)
 17) GMP/6.2.0-GCCcore-9.3.0                       (H)
 18) libffi/3.3-GCCcore-9.3.0                      (H)
 19) Python/3.8.2-GCCcore-9.3.0
 20) pybind11/2.4.3-GCCcore-9.3.0-Python-3.8.2     (H)
 21) SciPy-bundle/2020.03-intel-2020a-Python-3.8.2
 22) libpng/1.6.37-GCCcore-9.3.0                   (H)
 23) freetype/2.10.1-GCCcore-9.3.0                 (H)
 24) expat/2.2.9-GCCcore-9.3.0                     (H)
 25) util-linux/2.35-GCCcore-9.3.0                 (H)
 26) fontconfig/2.13.92-GCCcore-9.3.0              (H)
 27) xorg-macros/1.19.2-GCCcore-9.3.0              (H)
 28) libpciaccess/0.16-GCCcore-9.3.0               (H)
 29) X11/20200222-GCCcore-9.3.0                    (H)
 30) Tk/8.6.10-GCCcore-9.3.0                       (H)
 31) Tkinter/3.8.2-GCCcore-9.3.0                   (H)
 32) matplotlib/3.2.1-intel-2020a-Python-3.8.2

  Where:
   H:  Hidden Module

 

Program starting... 

User Info Loaded!
Loaded user features from user_features/feat_g_a_o_c.csv
User features shape:  (943, 536) 

Matrix Dimensions for  X_train1
X_train1  shape: (39633, 2)
X_train1  unique users: 943
X_train1  unique items: 1440


X_train1  matrix sparsity: 97.1%


Matrix Dimensions for  X_test1
X_test1  shape: (29942, 2)
X_test1  unique users: 943
X_test1  unique items: 1465


X_test1  matrix sparsity: 97.8%


Matrix Dimensions for  X_train2
X_train2  shape: (69575, 2)
X_train2  unique users: 943
X_train2  unique items: 1575


X_train2  matrix sparsity: 95.3%


Matrix Dimensions for  X_test2
X_test2  shape: (30425, 2)
X_test2  unique users: 943
X_test2  unique items: 1574


X_test2  matrix sparsity: 98.0%


X train and test 1
Stats for  users
Train  users : 943
Test  users 943
cold-start  users : set()


Stats for  items
Train  items : 1440
Test  items 1465
cold-start  items : {'1032', '1541', '1501', '1230', '1435', '816', '1657', '1602', '437', '1403', '927', '1210', '1595', '1155', '1293', '1477', '442', '1471', '1156', '1239', '78', '1654', '1634', '745', '1175', '1528', '1412', '1644', '838', '1364', '1542', '1370', '1481', '439', '1495', '1027', '1626', '1402', '1639', '1443', '400', '920', '1596', '415', '1222', '1474', '726', '1486', '1223', '1200', '1104', '1610', '765', '1448', '777', '1303', '1043', '598', '1611', '1534', '1422', '1419', '1459', '1599', '35', '1517', '1662', '1509', '1314', '1598', '1309', '1617', '1374', '388', '1600', '438', '1642', '1490', '791', '1594', '1250', '817', '1231', '1521', '1578', '1003', '1096', '992', '784', '1515', '1310', '1548', '1454', '1550', '775', '572', '1456', '1446', '1444', '668', '1553', '1144', '37', '573', '1658', '1522', '1285', '1450', '1253', '1162', '1523', '830', '1246', '1540', '1638', '1480', '1660', '1609', '1325', '1354', '1676', '1416', '1397', '1597', '1672', '1002', '1531', '852', '804', '1505', '788', '1532', '858', '1467', '138'}


X train and test 2
Stats for  users
Train  users : 943
Test  users 943
cold-start  users : set()


Stats for  items
Train  items : 1575
Test  items 1574
cold-start  items : {'1650', '1562', '1646', '1130', '1666', '1549', '1579', '1673', '1582', '1572', '1681', '1614', '1526', '1543', '1584', '1186', '1452', '814', '1628', '1460', '1603', '599', '1504', '1621', '1571', '1576', '1453', '1497', '1408', '1679', '910', '897', '1546', '1667', '1613', '1674', '1447', '1675', '911', '913', '1665', '1593', '1365', '1590', '1436', '1616', '1498', '1624', '1398', '1606', '1492', '1577', '1275', '1525', '1659', '1236', '957', '1588', '1632', '1653', '1569', '1640', '1520', '1671', '1682', '600', '1570', '626', '1678', '1327', '1648', '1575', '1508', '1586', '1664', '1563', '1494', '1618', '1668', '1637', '1189', '1458', '1633', '1661', '1580', '1106', '677', '1583', '1663', '1432', '1627', '1489', '1649', '1651', '1581', '1476', '1669', '1493', '1510', '1235', '1647', '1499', '1565', '1680', '1677', '1625', '1645'}


Recommender Round 1: 

training epoch: 0
log likelihood: -15785.4599609375

training epoch: 1
log likelihood: -13165.7998046875

training epoch: 2
log likelihood: -12551.91015625

training epoch: 3
log likelihood: -11615.6298828125

training epoch: 4
log likelihood: -10453.8203125

training epoch: 5
log likelihood: -9383.9599609375

training epoch: 6
log likelihood: -8609.009765625

training epoch: 7
log likelihood: -8255.4296875

training epoch: 8
log likelihood: -7869.8701171875

training epoch: 9
log likelihood: -7602.2001953125

training epoch: 10
log likelihood: -7398.0400390625

training epoch: 11
log likelihood: -7359.60009765625

training epoch: 12
log likelihood: -7069.64013671875

training epoch: 13
log likelihood: -6891.740234375

training epoch: 14
log likelihood: -6823.240234375

training epoch: 15
log likelihood: -6648.7900390625

training epoch: 16
log likelihood: -6613.509765625

training epoch: 17
log likelihood: -6576.22021484375

training epoch: 18
log likelihood: -6391.06982421875

training epoch: 19
log likelihood: -6452.39013671875
recommendations_train shape:  (943, 50)
Scores shape:  (29942,)
count    29587.000000
mean         0.859730
std          1.472778
min         -4.473017
25%         -0.177720
50%          0.945935
75%          1.972568
max          4.771589
dtype: float64
precision: 0.085
recall: 0.258
hit rate: 0.912
Recommender Round 2: 

training epoch: 0
log likelihood: -26669.169921875

training epoch: 1
log likelihood: -22790.01953125

training epoch: 2
log likelihood: -19984.990234375

training epoch: 3
log likelihood: -17722.720703125

training epoch: 4
log likelihood: -16286.240234375

training epoch: 5
log likelihood: -15550.26953125

training epoch: 6
log likelihood: -14907.8896484375

training epoch: 7
log likelihood: -14382.5498046875

training epoch: 8
log likelihood: -13952.6904296875

training epoch: 9
log likelihood: -13865.7099609375

training epoch: 10
log likelihood: -13300.66015625

training epoch: 11
log likelihood: -13247.3603515625

training epoch: 12
log likelihood: -13049.7998046875

training epoch: 13
log likelihood: -12830.599609375

training epoch: 14
log likelihood: -12671.6298828125

training epoch: 15
log likelihood: -12554.25

training epoch: 16
log likelihood: -12481.25

training epoch: 17
log likelihood: -12472.330078125

training epoch: 18
log likelihood: -12277.98046875

training epoch: 19
log likelihood: -12231.9501953125
recommendations_train shape:  (943, 50)
Scores shape:  (30425,)
count    30264.000000
mean         0.824731
std          1.461324
min         -4.157901
25%         -0.198787
50%          0.893665
75%          1.920631
max          5.254640
dtype: float64
precision: 0.070
recall: 0.208
hit rate: 0.876
Recommendations are not written to file for N higher than 20.
Rec train shape:  (943, 1682)
Rec test shape:  (943, 1682)


CV with  log_reg  for  gender
y_train unique len:  2
y_test unique len:  2
>acc=0.704, f1=0.704, est=0.706, cfg={'log_reg__C': 0.001, 'log_reg__max_iter': 10000, 'log_reg__penalty': 'l2', 'log_reg__solver': 'newton-cg'} 

y_train unique len:  2
y_test unique len:  2
>acc=0.667, f1=0.667, est=0.710, cfg={'log_reg__C': 0.001, 'log_reg__max_iter': 10000, 'log_reg__penalty': 'l2', 'log_reg__solver': 'newton-cg'} 

y_train unique len:  2
y_test unique len:  2
>acc=0.661, f1=0.661, est=0.708, cfg={'log_reg__C': 0.001, 'log_reg__max_iter': 10000, 'log_reg__penalty': 'l2', 'log_reg__solver': 'newton-cg'} 

y_train unique len:  2
y_test unique len:  2
>acc=0.718, f1=0.718, est=0.706, cfg={'log_reg__C': 0.001, 'log_reg__max_iter': 10000, 'log_reg__penalty': 'l2', 'log_reg__solver': 'newton-cg'} 

y_train unique len:  2
y_test unique len:  2
>acc=0.739, f1=0.739, est=0.714, cfg={'log_reg__C': 0.001, 'log_reg__max_iter': 10000, 'log_reg__penalty': 'l2', 'log_reg__solver': 'newton-cg'} 

Accuracy: 0.698 (0.030) 

F1: 0.698 (0.030) 



CV with  log_reg  for  age
y_train unique len:  3
y_test unique len:  3
>acc=0.529, f1=0.529, est=0.595, cfg={'log_reg__C': 0.001, 'log_reg__max_iter': 10000, 'log_reg__penalty': 'l2', 'log_reg__solver': 'newton-cg'} 

y_train unique len:  3
y_test unique len:  3
>acc=0.561, f1=0.561, est=0.597, cfg={'log_reg__C': 0.001, 'log_reg__max_iter': 10000, 'log_reg__penalty': 'l2', 'log_reg__solver': 'newton-cg'} 

y_train unique len:  3
y_test unique len:  3
>acc=0.561, f1=0.561, est=0.582, cfg={'log_reg__C': 0.01, 'log_reg__max_iter': 10000, 'log_reg__penalty': 'l2', 'log_reg__solver': 'newton-cg'} 

y_train unique len:  3
y_test unique len:  3
>acc=0.569, f1=0.569, est=0.589, cfg={'log_reg__C': 0.01, 'log_reg__max_iter': 10000, 'log_reg__penalty': 'l2', 'log_reg__solver': 'newton-cg'} 

y_train unique len:  3
y_test unique len:  3
>acc=0.569, f1=0.569, est=0.599, cfg={'log_reg__C': 0.01, 'log_reg__max_iter': 10000, 'log_reg__penalty': 'l2', 'log_reg__solver': 'newton-cg'} 

Accuracy: 0.558 (0.015) 

F1: 0.558 (0.015) 



CV with  log_reg  for  occupation
y_train unique len:  21
y_test unique len:  20
>acc=0.185, f1=0.185, est=0.202, cfg={'log_reg__C': 0.001, 'log_reg__max_iter': 10000, 'log_reg__penalty': 'l2', 'log_reg__solver': 'saga'} 

y_train unique len:  21
y_test unique len:  21
>acc=0.148, f1=0.148, est=0.221, cfg={'log_reg__C': 0.01, 'log_reg__max_iter': 10000, 'log_reg__penalty': 'l2', 'log_reg__solver': 'newton-cg'} 

y_train unique len:  21
y_test unique len:  20
>acc=0.190, f1=0.190, est=0.215, cfg={'log_reg__C': 0.001, 'log_reg__max_iter': 10000, 'log_reg__penalty': 'l2', 'log_reg__solver': 'newton-cg'} 

y_train unique len:  21
y_test unique len:  21
>acc=0.181, f1=0.181, est=0.203, cfg={'log_reg__C': 0.001, 'log_reg__max_iter': 10000, 'log_reg__penalty': 'l2', 'log_reg__solver': 'newton-cg'} 

y_train unique len:  21
y_test unique len:  21
>acc=0.213, f1=0.213, est=0.209, cfg={'log_reg__C': 0.001, 'log_reg__max_iter': 10000, 'log_reg__penalty': 'l2', 'log_reg__solver': 'newton-cg'} 

Accuracy: 0.183 (0.021) 

F1: 0.183 (0.021) 



CV with  log_reg  for  city
y_train unique len:  442
y_test unique len:  139
>acc=0.021, f1=0.021, est=0.036, cfg={'log_reg__C': 0.01, 'log_reg__max_iter': 10000, 'log_reg__penalty': 'l2', 'log_reg__solver': 'sag'} 

y_train unique len:  431
y_test unique len:  145
>acc=0.026, f1=0.026, est=0.042, cfg={'log_reg__C': 0.01, 'log_reg__max_iter': 10000, 'log_reg__penalty': 'l2', 'log_reg__solver': 'newton-cg'} 

y_train unique len:  434
y_test unique len:  143
>acc=0.032, f1=0.032, est=0.028, cfg={'log_reg__C': 0.001, 'log_reg__max_iter': 10000, 'log_reg__penalty': 'l2', 'log_reg__solver': 'newton-cg'} 

y_train unique len:  428
y_test unique len:  148
>acc=0.043, f1=0.043, est=0.045, cfg={'log_reg__C': 0.01, 'log_reg__max_iter': 10000, 'log_reg__penalty': 'l2', 'log_reg__solver': 'sag'} 

y_train unique len:  428
y_test unique len:  149
>acc=0.037, f1=0.037, est=0.046, cfg={'log_reg__C': 0.001, 'log_reg__max_iter': 10000, 'log_reg__penalty': 'l2', 'log_reg__solver': 'newton-cg'} 

Accuracy: 0.032 (0.008) 

F1: 0.032 (0.008) 

Linux idun-02-01 4.18.0-193.el8.x86_64 #1 SMP Fri May 8 10:59:10 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux
